# 代码风格与提交规范

## 语言与类型
- TypeScript 严格模式：启用 `strict`；尽量避免 `any`；明确返回类型。
- 模块组织：后端按 NestJS 模块划分；前端按页面、组件、状态、服务划分。

## 命名与结构
- 变量/函数：语义化小驼峰；类/类型：大驼峰；常量：全大写下划线。
- 文件：后端模块名统一；前端组件名与目录一致；避免超长文件。
- 目录：保持简洁，避免深层嵌套；公共工具抽到 `utils/`。

## ESLint/Prettier（建议规则）
- ESLint：`no-unused-vars`、`eqeqeq`、`no-implicit-any`、`prefer-const`、`no-console`（后端允许日志模块使用）。
- Prettier：统一行宽、缩进、引号、分号；与 ESLint 协同。

## 错误码与接口规范
- REST 风格：资源路径清晰；动词用在方法上；参数尽量用查询或主体。
- 错误码：
  - `400` 参数错误/校验失败
  - `401` 未认证
  - `403` 无权限（ACL 或只读限制）
  - `404` 不存在
  - `409` 版本冲突（revision 落后）
  - `422` 语义错误（如公式解析失败）
  - `500` 服务内部错误
- 错误响应结构：`{ code, message, details? }`

## 前端组件与状态
- 组件：职责单一，避免多功能耦合；长列表与表格走虚拟滚动。
- 状态：Pinia 模块化；只存必要状态；与后端契约映射清晰。
- 网络：统一请求封装；错误提示一致；重试与刷新策略可配置。

## 公式与数据一致性
- 前端即时重算并标记未保存；后端进行基本校验与可选重算；区域引用遵循 Luckysheet 规则。
- 对只读行/列的编辑请求在前端禁用，在后端拒绝。

## 提交与分支
- 分支命名：`feat/<模块>-<简述>`、`fix/<模块>-<问题>`、`docs/<文档>`、`chore/<维护>`。
- 提交格式：`<type>(<scope>): <subject>`；详见 `docs/contributing.md`。

## 文档与注释
- 必要文档：变更点与接口契约；复杂逻辑补充说明。
- 注释：清晰简短；避免与代码重复；关键算法与边界条件需标注。

—— 完 ——